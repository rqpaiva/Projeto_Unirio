<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análise de Cancelamento de Corridas</title>
    <script src="https://cdn.jsdelivr.net/npm/danfojs@1.1.2/lib/bundle.js"></script>
</head>
<body>
    <h1>Análise de Cancelamento de Corridas</h1>
    <p>Carregue os dados de um aplicativo de mobilidade urbana para realizar uma análise estatística das características das corridas.</p>
    
    <h2>Carregue seus dados:</h2>
    <input type="file" id="fileInput">
    <button id="loadButton">Carregar Dados</button>
    <p id="status"></p>
    
    <h2>Resultado da Análise</h2>
    <p id="analysisResult">Análise de dados JSON não implementada ainda.</p>

    <script>
        const fileInput = document.getElementById('fileInput');
        const loadButton = document.getElementById('loadButton');
        const statusText = document.getElementById('status');
        const analysisResult = document.getElementById('analysisResult');

        loadButton.addEventListener('click', async () => {
            const file = fileInput.files[0];
            if (!file) {
                statusText.innerHTML = "Nenhum arquivo selecionado.";
                return;
            }

            const reader = new FileReader();
            reader.onload = async (e) => {
                const csvData = e.target.result;

                try {
                    // Carregar os dados CSV
                    statusText.innerHTML = "Processando arquivo CSV...";
                    const df = dfd.readCSV(csvData); // Lendo CSV para DataFrame
                    
                    // Verificar tipos de dados
                    console.log("Tipos de dados das colunas:", df.dtypes);

                    // Remover linhas com valores nulos, se necessário
                    const dfClean = df.dropna();
                    console.log("DataFrame após remoção de nulos:", dfClean);

                    // Exibir algumas linhas para conferência
                    console.log("Primeiras linhas do DataFrame:", dfClean.head());

                    // Exibir resultado na página
                    analysisResult.innerHTML = "Análise realizada com sucesso!";
                    statusText.innerHTML = `Arquivo carregado com sucesso: ${file.name}`;

                } catch (error) {
                    console.error("Erro ao processar o arquivo CSV:", error);
                    statusText.innerHTML = "Erro: O arquivo carregado não é um DataFrame válido.";
                }
            };

            reader.readAsText(file);
        });
    </script>
</body>
</html>